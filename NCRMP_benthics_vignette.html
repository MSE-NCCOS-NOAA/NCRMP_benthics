<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Sarah Groves" />

<meta name="date" content="2019-04-11" />

<title>NCRMP Benthics statistical package in R</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">NCRMP Benthics statistical package in R</h1>
<h4 class="author">Sarah Groves</h4>
<h4 class="date">2019-04-11</h4>


<div id="TOC">
<ul>
<li><a href="#description">Description</a><ul>
<li><a href="#installation">Installation</a></li>
</ul></li>
<li><a href="#to-use-this-package-as-a-data-repository">To use this package as a data repository</a><ul>
<li><a href="#datasets">Datasets</a></li>
</ul></li>
<li><a href="#to-use-the-functions-in-this-package">To use the functions in this package</a></li>
<li><a href="#functions-for-specific-regions">Functions for specific regions</a><ul>
<li><a href="#benthic-cover">Benthic cover</a></li>
<li><a href="#coral-density">Coral density</a></li>
<li><a href="#species-richness-and-diversity">Species richness and diversity</a></li>
<li><a href="#mortality">Mortality</a></li>
<li><a href="#invertebrate-density">Invertebrate density</a></li>
<li><a href="#disease-prevalence">Disease prevalence</a></li>
</ul></li>
<li><a href="#functions-for-all-regions-and-years">Functions for all regions and years</a><ul>
<li><a href="#esa-listed-corals---presence-absence">ESA listed corals - presence absence</a></li>
<li><a href="#bleaching-abundance">Bleaching abundance</a></li>
</ul></li>
<li><a href="#frequently-asked-questions">Frequently asked questions:</a></li>
<li><a href="#ncrmp-species-filter-developed-in-status-report-meetings">NCRMP species filter developed in status report meetings</a></li>
<li><a href="#disclaimer">Disclaimer</a></li>
</ul>
</div>

<div id="description" class="section level1">
<h1>Description</h1>
<p>The ncrmp.benthic.analysis package is designed to use benthic coral reef data collected from the Atlantic regions of NOAA’s National Coral Reef Monitoring Program (NCRMP) to complete the following:</p>
<ol style="list-style-type: decimal">
<li><p>Compute summary statistics (e.g. coral density, percent cover, species richness, old and recent mortality, disease prevalence, <em>Diadema</em> density) from the site to the regional level as well as presence/absence of ESA species and bleaching abundance at the strata and site levels, respectively.</p></li>
<li><p>House all current NCRMP benthic data ranging from analysis ready data to regional domain estimates in a standardized format. This includes all metrics listed in item #1 calculated at the site, strata and regional level (as applicable) as well as the most recent sampling grids and NTOT files. There are over 250 dataframes stored in this package.</p></li>
</ol>
<p>Note:</p>
<ul>
<li><p>This package assumes some familiarity with NCRMP sampling methods and analysis ready (AR) data formats. NCEI and CoRIS archived AR data, data dictionaries and sampling protocols can be found on the NCRMP project page, <a href="https://coastalscience.noaa.gov/project/national-coral-reef-monitoring-program-biological-socioeconomic/" class="uri">https://coastalscience.noaa.gov/project/national-coral-reef-monitoring-program-biological-socioeconomic/</a> under “Products, Datasets and Reports”</p></li>
<li><p>This package currently uses NOAA’s NCRMP Atlantic benthic data only. See <a href="https://github.com/jeremiaheb/rvc#reef-visual-census-statistical-package-in-r" class="uri">https://github.com/jeremiaheb/rvc#reef-visual-census-statistical-package-in-r</a> for Atlantic fish R package.</p></li>
<li><p>Where indicated in file names by NCRMP_FRRP or NCRMP_DRM, NCRMP and Disturbrance Response Monitoring (DRM; formerly known as Florida Reef Resilience Program or FRRP) data from 2014 to present have been combined during co-sampling (even) years. DRM only data are used for non-NCRMP (odd) years. We are in the process of changing the naming convention from FRRP to DRM but at present DRM and FRRP are used interchangeably. Please be patient while we complete this transition.</p></li>
<li><p>SEFCRI 2014 coral demographics, benthic cover and invertebrates/ESA corals data, FLK 2014 benthic cover and invertebrates/ESA corals data, and Tortugas 2018 coral demographic data are 2 stage (2 transects per site). Site level metrics for these regions and years are the mean of transect 1 and transect 2. Strata and regional means are then calculated from this site level data.</p></li>
</ul>
<p>For questions, please contact the repository owner, Sarah Groves, <a href="mailto:sarah.groves@noaa.gov" class="email">sarah.groves@noaa.gov</a></p>
<div id="ncrmp-regions-and-sampling-years" class="section level3">
<h3>NCRMP Regions and sampling years</h3>
<ul>
<li>Florida:
<ul>
<li>Southeast Florida (SEFCRI; 2014, 2016)</li>
<li>Florida Keys (FLK; 2014, 2016)</li>
<li>Dry Tortugas (Tortugas; 2014, 2016, 2018)</li>
</ul></li>
<li>Caribbean:
<ul>
<li>St. Thomas &amp; St. John (STTSTJ; 2013, 2015, 2017)</li>
<li>St. Croix (STX; 2015, 2017)</li>
<li>Puerto Rico (PRICO; 2014, 2016)</li>
</ul></li>
<li>Gulf of Mexico:
<ul>
<li>Flower Garden Banks National Marine Sanctuary (GOM; 2013, 2015, 2018)</li>
</ul></li>
</ul>
<p>Upcoming data additions: Southeast Florida and Florida Keys 2018 (in 2019), Caribbean 2019 (in 2020)</p>
</div>
<div id="installation" class="section level2">
<h2>Installation</h2>
<ol style="list-style-type: decimal">
<li><p>Download the zipped R package using the green “Clone or download” button.</p></li>
<li><p>In R studio, open the ncrmp.benthics.analysis R project in the folder of the same name and use the following code to install the pacakge. You must be in the in the ncrmp.benthics.analysis R project. If you aleady have devtools installed you can skip the first line.</p></li>
</ol>
<pre><code>install.packages(&#39;devtools&#39;)

devtools::install()</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><p>Exit the ncrmp.benthics.analysis R project and check your R library to confirm the package installed. At this point you can either delete the files from the zipped folder or retain them if you are interested in the analysis code.</p></li>
<li><p>From your current project, use the following code to load and use the package.</p></li>
</ol>
<pre><code>library(ncrmp.benthics.analysis) </code></pre>
<ol start="5" style="list-style-type: decimal">
<li>To update the package (when new data is added), repeat steps 1-4. If you are having trouble, try deleting the old version first before intalling the new one.</li>
</ol>
<p>Note: Requires R version 3.4.1 or higher.</p>
<p>Currently, you cannot load the package directly from Git Hub using devtools::install_github(‘shgroves/NCRMP_benthics’). Future updates will inlcude this feature.</p>
<hr />
</div>
</div>
<div id="to-use-this-package-as-a-data-repository" class="section level1">
<h1>To use this package as a data repository</h1>
<p>To use this package as a data repository requires very little experience with R! You will need to have R version 3.4.1 or higher installed on your computer as well as R Studio desktop. Please see <a href="https://cran.r-project.org/doc/manuals/r-release/R-admin.html" class="uri">https://cran.r-project.org/doc/manuals/r-release/R-admin.html</a> and <a href="https://www.rstudio.com/products/rstudio/download/" class="uri">https://www.rstudio.com/products/rstudio/download/</a> for more information.</p>
<p>Because all datasets are stored in the R package, all that is required to access these dataframes is to load the package, and type the name of the dataset. You can then begin using it in your code or you can assign it to an object if you want to store it in your Global Environment.</p>
<p><strong>Examples:</strong></p>
<p><strong>Export a dataframe</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># require(ncrmp.benthics.analysis)</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co"># write.csv(NCRMP_DRM_FLK_2014_17_density_site, &quot;Your file path\\NCRMP_DRM_FLK_14_16_density_site.csv&quot;, row.names = F)</span></a></code></pre></div>
<p><strong>Use a dataframe in a ggplot</strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">require</span>(ncrmp.benthics.analysis)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt; Loading required package: ncrmp.benthics.analysis</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="kw">require</span>(ggplot2)</a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; Loading required package: ggplot2</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; Warning: package &#39;ggplot2&#39; was built under R version 3.5.3</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co"># Load weighted strata means</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8">Hardcoral &lt;-<span class="st"> </span>NCRMP_STTSTJ_<span class="dv">2013</span>_<span class="dv">17</span>_wh_cover_region <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="st">  </span><span class="co"># filter to just hardcoral</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(cover_group <span class="op">==</span><span class="st"> &quot;HARD CORALS&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="st">  </span><span class="co"># Change Year to factor so R sees it as a grouping variable and not a number</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">YEAR =</span> <span class="kw">as.factor</span>(YEAR))</a>
<a class="sourceLine" id="cb4-14" data-line-number="14"></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co"># Create your plot</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="kw">ggplot</span>(Hardcoral, <span class="kw">aes</span>(<span class="dt">x =</span> YEAR, <span class="dt">y =</span> avCvr, <span class="dt">group =</span> YEAR)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> YEAR), <span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb4-18" data-line-number="18">           <span class="dt">position=</span><span class="kw">position_dodge</span>(),</a>
<a class="sourceLine" id="cb4-19" data-line-number="19">           <span class="dt">size=</span>.<span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co"># Add error bars</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymax =</span> avCvr<span class="op">+</span>std, <span class="dt">ymin =</span> avCvr<span class="op">-</span>std), <span class="dt">width =</span> <span class="fl">.5</span>, <span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co"># Set the y axis scale</span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">25</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="co"># Add axis labels</span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Year&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Cover (%)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Hard coral cover&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28"><span class="co"># Remove legend </span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA+VBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrYAujgzMzM6AAA6ADo6AGY6OgA6OmY6ZmY6kNtNTU1NTW5NTY5NbqtNjshhnP9mAABmADpmAGZmOgBmZmZmkNtmtttmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQOmaQZmaQkDqQkLaQtpCQttuQ27aQ2/+rbk2rbm6rbo6ryKur5P+2ZgC2tpC2ttu229u22/+2/9u2///Ijk3I///bkDrbtmbbtpDb29vb/7bb///kq27k///r6+v4dm3/tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///+/bfD3AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJP0lEQVR4nO2dC3vbNBiF3a4NywYsYyMwWDpooeG2dUADjHXpWLeRZiRN/f9/DLr4Gss5li+J6pzzPFtzOf7y+Y0ky44seT61Ut6mE3BdBAREQEAEBERAQAQEREBABARkC2i8+1L9nffv5TgWw07haIvh/oVlAusWAQEREFA1QOcfe97O1wrK2Nt94Z93vb2/YkDy6Yl88OGR5+29SPii7SJAGa/+pHm/o1/6JLH5OlUJ0NhTGojMb3W9/Qv1fO9RCGgin+6IvZ50g0dJn94uBJT1TrsD9fpAPEpvXte+F5I1IC/UPZGv/Dan3Y54JJ4KaDtP/Q9DLwC0GIp9Olc+77Hccv9C+5LbBbtr9Mr3RrsvxXvipdfRx6xXVQAJ/fPHj11PZi4L1rQrX5M7rqSfxq+Mdk60L7ldAMjg9cfin6xhwXtjiSrYfI2qVMV02Y92VFaHRCOt60j8YCIBKSBL25m9CowMOQm+kWjztaoKoHnf+/TnP9/0bQEtb2f2qjdFDbvBgPTOxG2JrgvquOP7OVVM+9Lbmb3is3aeyVgRvI30CqoB6lzIQ3DYoIpG+rFsSJON9LSvmuZUw7u8ndkrfV/JMineeyoO9UPZBt0sQGJnlKIdnRgO83IXE4d56ctsZ/Qqn/q0SXzYvFmAdJ/u6Sj+al8/8vb+TnUU5RFalIWoo6h8me1MXvlhQWGUL916fDOq2NaJgIAICIiAgAgIiICAVgCaHfR6x77/ttfrffZqbQm5pnxAV9+d+rMnp/7Z8RrTcU/5gC4fiv/Ojq9/PV1fNg5qdRskStHVUU/VNN+/LbSWnJzSSkDXzw9VLYtL0XsLWZmdC1QE0NXRYfAoaoeaSse9QAUAzQ6i5pmA8vlcPnjnX/8WHuabSse9QBiQ7P/I5ln8vR8dyJpKx71ABaqYSU2l414gAkJeAgJeAgJeAgJeAgJeAgJeAgJeAgJeAgJeAgJeAgJeAgJeAgJeAgLecoC2TyxBeV4CAl4CAl4CAl4CAl4CAl4CAl4CAl4CAl4CAl4CAl4CAl4CAl4CAl4CAl4CAl4CAl4MKBhpf3XUe/COgLIKRtpfPz/23z4koKyCkfZX37/yZ99wEGduKZp9+04VJo60N0iOtJfDgDUgqaa+L/cCFQGkRtrHJYiAlqRHkrMNWs1HVTMexUwKR9qzH2SjptJxLxABIS8BAS8BAS8BAS8BAS8BAS8BAS8BAS8BAS8BAS8BAS8BAS8BAS8BAW85QNsnlqA8LwEBLwEBLwEBLwEBLwEBLwEBLwEBLwEBLwEBrwnQOLHmCgEtA5r3QzJjvSgBAaUAzb9MLJuTekJAFmoqHfcCERDymgGJhii/ASIg3x8NfH96N38Rr6bScS9QBpBqlxfDFCA1NjE1p31T6bgXKFuC5v39i3QVu1RgUnPaN5WOe4FMVSxafE/r7P7vogSl57RvKh33ApnboEm6Fy2rGOe0T2vsDeInEhDntA8lV2aUi4eN4sN8NICcU7aLNvoLuQqsbIQWP7wkoFWA0lWMc9ovV7ElQJzT3kpNpeNeIAJC3mVAvB605M2UIHGWEXSBeEXxfU4VG/GadOw1AcJqKh33AhEQ8hIQ8NYNyCugNexXbYHWUILK8sjmuolAJkDqgisBBV4DoHmfgGKvAZA/hsu526TTPkDyir3Ubj0/+7QPUAHZpENAQG0ENPa8AW6ICqoddzmkT1b33/QHi2Enz7ztJUgc5uWRfsJG+j0BYa+pio1lFZv3a7oe1EJA/gRcL9t6QFA26RAQUElAjlw3MQFa2fpssARtpCgaS5AcSL76hN4mnRYC8tUPG3UN4mwnIMnItX6QU4BGK692bDsgUL+2HpCrl1ydAVRANum0EdDYyVMNdwCNZfvs3smqM4CCNii+3KGG4JWe7Lb9gNStCOUn/W8foKUqpm9FKD/hdgsBLTfSaqR96Un/a7tov9Gr/ys/PBwnXW5O+zaWIAOg8pP+tw6QaqMXw8TPYjO2QamR9rrxSZzMSzDlJ/1vG6BRZ/kB+0FJQPGZqnO/ixHQugJVArQYhv2fVaMXbNLZNKAiP4/kh84A0t3oFKkbDqhaoCyg4F5MdXc4AeXcFu6ha65NpeNeIBOgAmoqHfcCERBQdUCFDhK1/MR+UwH9C4QNDexXbYEICIiAgAgIiICACAioJKCEagBU9JNK51hDIJagHDkEyM0ep0uAPgLCBgIiIAIiIAIiIAIiIAIiIAIiIAIiIAK6mYBqvW5SHFDepP8OAvocCBvKAMqb9J+AtHIn/ScgrdxJ/2u7aF8DoCBQdUDZ/YeAcif9ZwlKyDSnPQERUCFAuZP+E1CgvEn/CcgkAiIgAiIgAiIgAiIgAiIgS0BFLmhuNaASIiACIqANACrSmG01oBJyCFBCNQAKAlUHFASqDsiwm3ZUWIIIiIAIiICKASo0nGObAZUQAREQAREQAREQAREQAREQARGQK4Dy5nIlIK3cOe0JKChAefNJE5BW7pz28FLLbehwNVBShYYBx1O228hqhQBnA1mUoHWk414gyzao6XTcC1TgKJac0377ZNkP2j61Y83zBkVAQAQEVC+g2YG6fTNqttTh77IX3zVdKVDq/usKgWSc4DZTrFoByf7S7MlpdPqmFihTKVkeBo2B0vdfVwnk6/5vIdUK6FLmcHYcdp30AmVSth0pY6D0/dfVMire9a29DRIfHXe+QzBlOlKZQPH919UzKp5Q3YBkvzI+fdPpzA7u23/32UDp+68rZWRx7lQzoKujw+TpW1iC7E/mcgLZt0PGQIVboPqPYjL/+PSt9H41HOjssHCAWgHpbBKnb9k1ACsGiu+/rhDIqqLWCijsYGS6L7ZtUMOBbL4v9qSBCAiIgIAICIiAgAgIiICAXAS0GKrlFqfdDrQ2LxcBBYsGj1Yttrg2OQlIrdg57Q6wsXm5CWje7+gVlRdDz5P1Ta1Pec+f3v3JW7FMbhNyE5A/2fnlzonk01EL46plhEWx2kCz5CggUXJkM6RWVRZ0/pOt0fTOyQaqnaOAggWnx3pQimA18eQSsNM7K1eBbUKOAwoOZPP+zokqQQQUSgOaBOsGTySoCUtQQhrQYijICDAS1LRLQAkFi97Lw7wsRSPx51l/QEDuiYCACAiIgIAICIiAgAgIiICACAiIgID+B4Eco05XFA2yAAAAAElFTkSuQmCC" /><!-- --></p>
<p><strong>Add dataframe to the Global Environment</strong></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># require(ncrmp.benthics.analysis)</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co"># #The &#39;data&#39; function will load a dataframe to the Global Environment keeping the existing name, </span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co"># </span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co"># data(&quot;NCRMP_DRM_FLK_2014_17_density_site&quot;)</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co"># or you can give it a new name </span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co"># dat &lt;- NCRMP_DRM_FLK_2014_17_density_site</span></a></code></pre></div>
<div id="datasets" class="section level2">
<h2>Datasets</h2>
<p>Datasets contained within the package at the strata and regional level are created using the default function parameters:</p>
<ul>
<li>For Florida regions:
<ul>
<li>project = “NCRMP” (NCRMP only) or “NCRMP_FRRP” (NCRMP and DRM combined)</li>
<li>species filter = FALSE (filter not applied)</li>
<li>analysis_strat = “STRAT_PROT”</li>
</ul></li>
<li>For all Carib regions:
<ul>
<li>project = “NCRMP”</li>
<li>species filter = FALSE</li>
<li>analysis_strat = “HABITAT_DEPTH” (DEPTH refers to depth stratification, deep or shallow)</li>
</ul></li>
<li>For GOM:
<ul>
<li>project = “NCRMP”</li>
<li>species filter = FALSE</li>
<li>analysis_strat = “HABITAT_DEPTH” (There is currently only one strata in the GOM region - FGBNMS. This means strata level means will be identical to regional means and neither value is weighted.)</li>
</ul></li>
</ul>
<div id="analysis-ready-ar-data" class="section level3">
<h3>Analysis Ready (AR) data</h3>
<p>Analysis ready NCRMP datasets for all regions and years are contained within this package in the most recent NCRMP Atlantic archive format. AR datasets can be identified because they begin with the region code followed by the year and then the data type; benthic_cover, coral_demographics or inverts_ESAcorals. Two stage (2 transect) data are identified in the file name except for the Tortugas 2018 data. Tortugas 2018 coral demographics surveys were a joint mission between NCRMP and DRM where two transects were conducted at each site. The NCRMP and DRM data are combined and indistinguishable. All other datasets are single transect.</p>
<ul>
<li>Data format:
<ul>
<li>REGION_YEAR_datatype</li>
</ul></li>
<li>Examples:
<ul>
<li>FLK_2016_coral_demographics,</li>
<li>SEFCRI_2014_2stage_benthic_cover<br />
</li>
<li>FGBNMS_2013_inverts_ESAcorals</li>
</ul></li>
</ul>
<p>In addition, the following AR Florida DRM and Sanctuary Coral Reef Ecosystem Assessment Monitoring (SCREAM) datasets in NCRMP format are stored in the package. Combined DRM and SCREAM data are from 1999 to 2013 (not all regions are sampled each year) and individual DRM regions are 2014 to the most recent year of sampling.</p>
<ul>
<li>preNCRMP_SCREAM_DRM_coral_demographics<br />
</li>
<li>FRRP_SEFCRI_2017_2stage_demo_data - includes data from 2014 - 2017</li>
<li>FRRP_FLK_2017_2stage_demo_data</li>
<li>FRRP_Tort_2017_2stage_demo_data</li>
</ul>
</div>
<div id="summary-dataframes" class="section level3">
<h3>Summary dataframes</h3>
<p>Summary dataframes are provided for site, strata and weighted regional means. Every function listed below can produce several dataframes. Although there are too many to list individually, all provided dataframes follow a standard naming convention. Summary dataframes can be identified because they begin with the project or projects (NCRMP or NCRMP_DRM), followed by the region, year(s) and data type and level (site, strata, region). See associated functions used to create these dataframes (below) for more information. To view all of the data contained within this package you can 1. download the package from GitHub and view the ‘data’ folder or 2. use the following code to view all of the datasets in R.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co"># data(package=&#39;ncrmp.benthics.analysis&#39;)</span></a></code></pre></div>
<ul>
<li>Data format:
<ul>
<li>PROJECT_REGION_YEAR_datatype_level</li>
</ul></li>
<li>Examples:
<ul>
<li>NCRMP_DRM_FLK_2014_17_dis_prev_site,</li>
<li>NCRMP_FGBNMS_2013_15_unwh_density_strata,<br />
</li>
<li>NCRMP_FLK_2014_16_wh_rec_mort_region,</li>
<li>NCRMP_PRICO_2014_16_unwh_richness_strata,</li>
<li>NCRMP_STX_2015_17_wh_cover_region</li>
</ul></li>
</ul>
<p>In addition, there are two dataframes that contain all regions and years</p>
<ul>
<li>NCRMP_AllRegions_Years_ESA_PresAbs</li>
<li>NCRMP_bleaching_abundance_Allyears_Allregions</li>
</ul>
</div>
<div id="shapefiles-and-ntot-files" class="section level3">
<h3>Shapefiles and NTOT files</h3>
<p>The most recent sampling grid shapefiles used for site allocation and associated NTOT (grid summary) files are also contained in the package. Grids can be used in R or exported as shapefiles. The NTOT files are required to properly apply the weighting scheme to summary data. The Florida Keys National Marine Sanctuary (FKNMS) and the Flower Garden Banks National Marine Sanctuary (FGBNMS) boundary polygons are also contained in the package. More boundary polygons for other regions will be added in future updates.</p>
<ul>
<li>Sampling grids:
<ul>
<li>SEFCRI_2016_sample_frame</li>
<li>FLK_TORT_2018_sample_frame</li>
<li>STTSTJ_2017_sample_frame_WGS1984</li>
<li>STX_2017_sample_frame_WGS1984</li>
<li>PRICO_2016_sample_frame_WGS1984</li>
<li>FGBNMS_2015_sample_frame_WGS1984</li>
</ul></li>
<li>NTOT files:
<ul>
<li>USVI_2017_NTOT (STTSTJ &amp; STX)</li>
<li>FL_2018_NTOT (SEFCRI, FLK &amp; Tortugas)</li>
<li>PRICO_2016_NTOT</li>
<li>FGBNMS_2018_NTOT</li>
</ul></li>
<li>Boundaries
<ul>
<li>FKNMS_boundary</li>
<li>FGBNMS_boundary</li>
</ul></li>
</ul>
</div>
<div id="additional-files" class="section level3">
<h3>Additional files</h3>
<ul>
<li>ncrmp_frrp_sppcodes: species code, species names and benthic categories for NCRMP and other Florida monitoring programs.</li>
</ul>
</div>
</div>
</div>
<div id="to-use-the-functions-in-this-package" class="section level1">
<h1>To use the functions in this package</h1>
<p>If you would like to run the AR data through the functions, apply preset species filters to certain functions or just know more about how NCRMP metrics are calculated, please feel free to use these functions or check out the code. Comments or suggestions on how to approve the package are welcome.</p>
</div>
<div id="functions-for-specific-regions" class="section level1">
<h1>Functions for specific regions</h1>
<div id="these-functions-create-outputs-that-contain-a-single-region-and-either-single-or-multiple-sampling-years.-they-all-use-a-stratified-random-sampling-weighting-scheme-to-calculate-regional-sampling-domain-level-metrics." class="section level3">
<h3>These functions create outputs that contain a single region and either single or multiple sampling years. They all use a stratified random sampling weighting scheme to calculate regional (sampling domain) level metrics.</h3>
</div>
<div id="benthic-cover" class="section level2">
<h2>Benthic cover</h2>
<div id="ncrmp_calculate_cover" class="section level3">
<h3>1. NCRMP_calculate_cover</h3>
<p><strong>Calculates percent cover from species to regional level for individual years</strong></p>
<ul>
<li>parameters:
<ul>
<li><p>region: “SEFCRI”, “FLK”, “Tortugas”, “STTSTJ”, “STX”, “PRICO”, “GOM”</p></li>
<li><p>year: 2013, 2014, 2015, 2016, 2017, 2018 Note - for each region, only years where sampling was conducted will run</p></li>
<li><p>analysis_strat: “STRAT_PROT” (Florida regions only; default), “HABITAT_DEPTH” (Carib regions only; default), “STRAT” (Florida regions only ), “HABITAT” (Carib regions only)</p></li>
</ul></li>
<li>outputs (dataframes):
<ul>
<li><p>cover_group_key: a region specific key for species codes and major benthic categories</p></li>
<li><p>percent_cover_species: site level percent cover by species</p></li>
<li><p>percent_cover_site: site level percent cover by major benthic category</p></li>
<li><p>unwh_cover_strata: strata level percent cover of major benthic categories (unweighted)</p></li>
<li><p>Domain estimates: weighted regional (domain level) percent cover of major benthic categories</p></li>
<li><p>Domain_check: QAQC check that sums the regional percent cover. Should equal ~100</p></li>
</ul></li>
</ul>
<p>Associated functions: NCRMP_make_weighted_LPI_data, NCRMP_make_weighted_LPI_data_RC</p>
<p>Example:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">require</span>(ncrmp.benthics.analysis)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co"># Run function and assign names to dataframes </span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">tmp &lt;-<span class="st"> </span><span class="kw">NCRMP_calculate_cover</span>(<span class="dt">region =</span> <span class="st">&quot;SEFCRI&quot;</span>,</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">                             <span class="dt">year =</span> <span class="dv">2014</span>,</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">                             <span class="dt">analysis_strat =</span> <span class="st">&quot;STRAT&quot;</span>)</a>
<a class="sourceLine" id="cb7-8" data-line-number="8"></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co"># The function will store all of the function outputs as a list in tmp</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co"># Convert list objects to dataframes and rename </span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11">NCRMP_SEFCRI_<span class="dv">2014</span>_percent_cover_site &lt;-<span class="st"> </span>tmp<span class="op">$</span>percent_cover_site</a>
<a class="sourceLine" id="cb7-12" data-line-number="12">NCRMP_SEFCRI_<span class="dv">2014</span>_cover_group_key &lt;-<span class="st"> </span>tmp<span class="op">$</span>cover_group_key</a>
<a class="sourceLine" id="cb7-13" data-line-number="13">NCRMP_SEFCRI_<span class="dv">2014</span>_unwh_cover_strata &lt;-<span class="st"> </span>tmp<span class="op">$</span>unwh_cover_strata</a>
<a class="sourceLine" id="cb7-14" data-line-number="14">NCRMP_SEFCRI_<span class="dv">2014</span>_wh_cover_region &lt;-<span class="st"> </span>tmp<span class="op">$</span>Domain_est</a>
<a class="sourceLine" id="cb7-15" data-line-number="15">NCRMP_SEFCRI_<span class="dv">2014</span>_Domain_check &lt;-<span class="st"> </span>tmp<span class="op">$</span>Domain_check </a></code></pre></div>
</div>
<div id="ncrmp_make_weighted_lpi_data" class="section level3">
<h3>2. NCRMP_make_weighted_LPI_data</h3>
<p><strong>Applies weighting scheme to benthic cover data</strong></p>
<p>Analysis level strata = STRAT + PROT for Florida regions and HABITAT CODE + DEPTH STRAT for the Caribbean and GOM regions. These are the recommended and default settings.</p>
<p>This function is called within NCRMP_calculate_cover so the initial parameters you provide for region and year. will be passed on.</p>
<p>Example of weighting application for Florida:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#Calculate average cover (avcvr), stratum variance (svar), n and std at the strata and regional level using STRAT + PROT as the analysis strata. Inputdata = 1 stage site level cover for major benthic categories and ntot = the most recent NTOT file for the region, regardless of sampling year. </span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co"># cover_est &lt;- inputdata %&gt;%</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#    # group by analysis level strata</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#   dplyr::mutate(ANALYSIS_STRATUM = paste(STRAT, &quot;/ PROT =&quot;, PROT, sep = &quot; &quot;)) %&gt;%</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#   dplyr::group_by(ANALYSIS_STRATUM, STRAT, PROT, cover_group) %&gt;% </span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#   dplyr::summarise(</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#     # calculate mean cover</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#     avcvr = mean(Percent_Cvr),</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#     # calculate stratum variance</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#     svar = var(Percent_Cvr),</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#     # calculate N</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#     n = sum(n),</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#     # calculate mean stratum depth</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#     MIN_DEPTH = mean(MIN_DEPTH),</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#     MAX_DEPTH = mean(MAX_DEPTH),</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#     DEPTH_M = (MIN_DEPTH+MAX_DEPTH)/2) %&gt;%</span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">#   </span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="co">#   # convert 0 for stratum variance so that the sqrt is a small # but not a 0</span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="co">#   dplyr::mutate(svar = dplyr::case_when(svar == 0 ~ 0.00000001,</span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22"><span class="co">#                                         TRUE ~ svar)) %&gt;%</span></a>
<a class="sourceLine" id="cb8-23" data-line-number="23"><span class="co">#   dplyr::mutate(std = sqrt(svar))</span></a>
<a class="sourceLine" id="cb8-24" data-line-number="24"><span class="co"># </span></a>
<a class="sourceLine" id="cb8-25" data-line-number="25"><span class="co"># cover_est &lt;- cover_est %&gt;%</span></a>
<a class="sourceLine" id="cb8-26" data-line-number="26"><span class="co">#   # Merge ntot with cover_est</span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27"><span class="co">#   dplyr::full_join(., ntot) %&gt;%</span></a>
<a class="sourceLine" id="cb8-28" data-line-number="28"><span class="co">#   # stratum estimates</span></a>
<a class="sourceLine" id="cb8-29" data-line-number="29"><span class="co">#   dplyr::mutate(whavcvr = wh * avcvr,</span></a>
<a class="sourceLine" id="cb8-30" data-line-number="30"><span class="co">#                 whsvar = wh^2 * svar,</span></a>
<a class="sourceLine" id="cb8-31" data-line-number="31"><span class="co">#                 whstd = wh * std,</span></a>
<a class="sourceLine" id="cb8-32" data-line-number="32"><span class="co">#                 n = tidyr::replace_na(n, 0))</span></a>
<a class="sourceLine" id="cb8-33" data-line-number="33"><span class="co"># </span></a>
<a class="sourceLine" id="cb8-34" data-line-number="34"><span class="co"># # Reformat data</span></a>
<a class="sourceLine" id="cb8-35" data-line-number="35"><span class="co"># </span></a>
<a class="sourceLine" id="cb8-36" data-line-number="36"><span class="co"># # cover, unweighted by strata</span></a>
<a class="sourceLine" id="cb8-37" data-line-number="37"><span class="co"># unwh_cover_strata &lt;- cover_est %&gt;%</span></a>
<a class="sourceLine" id="cb8-38" data-line-number="38"><span class="co">#   dplyr::select(REGION, YEAR, ANALYSIS_STRATUM, STRAT, RUG_CD, PROT, DEPTH_M, NTOT, ngrtot, wh, cover_group, n, avcvr, svar, std) %&gt;%</span></a>
<a class="sourceLine" id="cb8-39" data-line-number="39"><span class="co">#   dplyr::mutate(METHOD = &quot;UNWEIGHTED&quot;) %&gt;%</span></a>
<a class="sourceLine" id="cb8-40" data-line-number="40"><span class="co">#   dplyr::mutate(n = tidyr::replace_na(n, 0))</span></a>
<a class="sourceLine" id="cb8-41" data-line-number="41"><span class="co"># </span></a>
<a class="sourceLine" id="cb8-42" data-line-number="42"><span class="co"># # Calculate Domain Estimates</span></a>
<a class="sourceLine" id="cb8-43" data-line-number="43"><span class="co">#   Domain_est &lt;- cover_est %&gt;%</span></a>
<a class="sourceLine" id="cb8-44" data-line-number="44"><span class="co">#     dplyr::group_by(REGION, YEAR, cover_group) %&gt;%</span></a>
<a class="sourceLine" id="cb8-45" data-line-number="45"><span class="co">#     dplyr::summarise(avCvr = sum(whavcvr),</span></a>
<a class="sourceLine" id="cb8-46" data-line-number="46"><span class="co">#                      var = sum(whsvar, na.rm = T),</span></a>
<a class="sourceLine" id="cb8-47" data-line-number="47"><span class="co">#                      std = sqrt(var),</span></a>
<a class="sourceLine" id="cb8-48" data-line-number="48"><span class="co">#                      ngrtot = sum(NTOT) )</span></a></code></pre></div>
<p>Example of weighting application for Caribbean and GOM:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co"># Calculate average cover (avcvr), stratum variance (svar), n and std at the strata and regional level using HABITAT + DEPTH_STRAT as the analysis strata. Inputdata = 1 stage site level cover for major benthic categories and ntot = the most recent NTOT file for the region, regardless of sampling year. </span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co"># </span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co"># cover_est &lt;- inputdata %&gt;%</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#   # group by analysis level strata</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#   dplyr::group_by(YEAR, ANALYSIS_STRATUM, STRAT, cover_group) %&gt;% </span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#   dplyr::summarise(</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#     # compute average cover</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#     avcvr = mean(Percent_Cvr),</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#     # compute stratum variance</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#     svar = var(Percent_Cvr),</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">#     # calculate N</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">#     n = sum(n),</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">#     # calculate mean stratum depth</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">#     MIN_DEPTH = mean(MIN_DEPTH),</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co">#     MAX_DEPTH = mean(MAX_DEPTH),</span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co">#     DEPTH_M = (MIN_DEPTH+MAX_DEPTH)/2) %&gt;%</span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="co">#   # convert 0 for stratum variance so that the sqrt is a small # but not a 0</span></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="co">#   dplyr::mutate(svar = dplyr::case_when(svar == 0 ~ 0.00000001,</span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="co">#                                         TRUE ~ svar)) %&gt;%</span></a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="co">#   dplyr::mutate(std = sqrt(svar))</span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22"><span class="co"># </span></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="co"># cover_est &lt;- cover_est %&gt;%</span></a>
<a class="sourceLine" id="cb9-24" data-line-number="24"><span class="co">#   # Merge ntot with cover_est</span></a>
<a class="sourceLine" id="cb9-25" data-line-number="25"><span class="co">#   dplyr::full_join(., ntot) %&gt;%</span></a>
<a class="sourceLine" id="cb9-26" data-line-number="26"><span class="co">#   # stratum estimates</span></a>
<a class="sourceLine" id="cb9-27" data-line-number="27"><span class="co">#   dplyr::mutate(whavcvr = wh * avcvr,</span></a>
<a class="sourceLine" id="cb9-28" data-line-number="28"><span class="co">#                 whsvar = wh^2 * svar,</span></a>
<a class="sourceLine" id="cb9-29" data-line-number="29"><span class="co">#                 whstd = wh * std,</span></a>
<a class="sourceLine" id="cb9-30" data-line-number="30"><span class="co">#                 n = tidyr::replace_na(n, 0),</span></a>
<a class="sourceLine" id="cb9-31" data-line-number="31"><span class="co">#                 # Add the following to match FL format</span></a>
<a class="sourceLine" id="cb9-32" data-line-number="32"><span class="co">#                 PROT = NA,</span></a>
<a class="sourceLine" id="cb9-33" data-line-number="33"><span class="co">#                 RUG_CD = NA)</span></a>
<a class="sourceLine" id="cb9-34" data-line-number="34"><span class="co"># </span></a>
<a class="sourceLine" id="cb9-35" data-line-number="35"><span class="co"># # Reformat data</span></a>
<a class="sourceLine" id="cb9-36" data-line-number="36"><span class="co"># </span></a>
<a class="sourceLine" id="cb9-37" data-line-number="37"><span class="co"># # cover, unweighted by strata</span></a>
<a class="sourceLine" id="cb9-38" data-line-number="38"><span class="co"># unwh_cover_strata &lt;- cover_est %&gt;%</span></a>
<a class="sourceLine" id="cb9-39" data-line-number="39"><span class="co">#   dplyr::select(REGION, YEAR, ANALYSIS_STRATUM, STRAT, RUG_CD, PROT, DEPTH_M, NTOT, ngrtot, wh, cover_group, n, avcvr, svar, std) %&gt;%</span></a>
<a class="sourceLine" id="cb9-40" data-line-number="40"><span class="co">#   dplyr::mutate(METHOD = &quot;UNWEIGHTED&quot;) %&gt;%</span></a>
<a class="sourceLine" id="cb9-41" data-line-number="41"><span class="co">#   dplyr::mutate(n = tidyr::replace_na(n, 0))</span></a>
<a class="sourceLine" id="cb9-42" data-line-number="42"><span class="co"># </span></a>
<a class="sourceLine" id="cb9-43" data-line-number="43"><span class="co"># </span></a>
<a class="sourceLine" id="cb9-44" data-line-number="44"><span class="co"># ## Calculate Domain Estimates</span></a>
<a class="sourceLine" id="cb9-45" data-line-number="45"><span class="co"># Domain_est &lt;- cover_est %&gt;%</span></a>
<a class="sourceLine" id="cb9-46" data-line-number="46"><span class="co">#   dplyr::group_by(REGION, YEAR, cover_group) %&gt;%</span></a>
<a class="sourceLine" id="cb9-47" data-line-number="47"><span class="co">#   dplyr::summarise(avCvr = sum(whavcvr),</span></a>
<a class="sourceLine" id="cb9-48" data-line-number="48"><span class="co">#                    var = sum(whsvar, na.rm = T),</span></a>
<a class="sourceLine" id="cb9-49" data-line-number="49"><span class="co">#                    std = sqrt(var),</span></a>
<a class="sourceLine" id="cb9-50" data-line-number="50"><span class="co">#                    ngrtot = sum(NTOT) )</span></a></code></pre></div>
</div>
<div id="ncrmp_make_weighted_lpi_data_rc" class="section level3">
<h3>3. NCRMP_make_weighted_LPI_data_RC</h3>
<p><strong>Applies weighting scheme to benthic cover data</strong></p>
<p>Analysis level strata = STRAT for Florida regions and HABITAT CODE for the Caribbean regions.</p>
<p>This function is called within NCRMP_calculate_cover so the initial parameters you provide for region and year will be passed on.</p>
<p>Example of weighting application for Florida:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co"># Calculate average cover (avcvr), stratum variance (svar), n and std aat the strata and regional level using STRAT as the analysis strata. Inputdata = 1 stage site level cover for major benthic categories and ntot = the most recent NTOT file for the region, regardless of sampling year. </span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co"># </span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co"># cover_est &lt;- inputdata %&gt;%</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#   # group by analysis level strata</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#   dplyr::mutate(ANALYSIS_STRATUM = paste(STRAT, &quot;/ PROT =&quot;, PROT, sep = &quot; &quot;)) %&gt;%</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#   dplyr::mutate(ANALYSIS_STRATUM = STRAT) %&gt;%</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#   dplyr::group_by(YEAR, ANALYSIS_STRATUM, STRAT, cover_group) %&gt;% </span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#   dplyr::summarise(</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#     # calculate mean cover</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#     avcvr = mean(Percent_Cvr),</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#     # calculate stratum variance</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#     svar = var(Percent_Cvr),</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#     # calculate N</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#     n = sum(n),</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">#     # calculate mean stratum depth</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="co">#     MIN_DEPTH = mean(MIN_DEPTH),</span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="co">#     MAX_DEPTH = mean(MAX_DEPTH),</span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="co">#     DEPTH_M = (MIN_DEPTH+MAX_DEPTH)/2) %&gt;%</span></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"><span class="co">#   </span></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="co">#   # convert 0 for stratum variance so that the sqrt is a small # but not a 0</span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"><span class="co">#   dplyr::mutate(svar = dplyr::case_when(svar == 0 ~ 0.00000001,</span></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="co">#                                         TRUE ~ svar)) %&gt;%</span></a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="co">#   dplyr::mutate(std = sqrt(svar))</span></a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="co"># </span></a>
<a class="sourceLine" id="cb10-26" data-line-number="26"><span class="co"># cover_est &lt;- cover_est %&gt;%</span></a>
<a class="sourceLine" id="cb10-27" data-line-number="27"><span class="co">#   # Merge ntot with coral_est_spp</span></a>
<a class="sourceLine" id="cb10-28" data-line-number="28"><span class="co">#   dplyr::full_join(., ntot) %&gt;%</span></a>
<a class="sourceLine" id="cb10-29" data-line-number="29"><span class="co">#   # stratum estimates</span></a>
<a class="sourceLine" id="cb10-30" data-line-number="30"><span class="co">#   dplyr::mutate(whavcvr = wh * avcvr,</span></a>
<a class="sourceLine" id="cb10-31" data-line-number="31"><span class="co">#                 whsvar = wh^2 * svar,</span></a>
<a class="sourceLine" id="cb10-32" data-line-number="32"><span class="co">#                 whstd = wh * std,</span></a>
<a class="sourceLine" id="cb10-33" data-line-number="33"><span class="co">#                 n = tidyr::replace_na(n, 0))</span></a>
<a class="sourceLine" id="cb10-34" data-line-number="34"><span class="co"># # Reformat data </span></a>
<a class="sourceLine" id="cb10-35" data-line-number="35"><span class="co"># </span></a>
<a class="sourceLine" id="cb10-36" data-line-number="36"><span class="co"># # cover, unweighted by strata</span></a>
<a class="sourceLine" id="cb10-37" data-line-number="37"><span class="co"># unwh_cover_strata &lt;- cover_est %&gt;%</span></a>
<a class="sourceLine" id="cb10-38" data-line-number="38"><span class="co">#   dplyr::select(REGION, YEAR, ANALYSIS_STRATUM, STRAT, RUG_CD,  DEPTH_M, NTOT, ngrtot, wh, cover_group, n, avcvr, svar, std) %&gt;%</span></a>
<a class="sourceLine" id="cb10-39" data-line-number="39"><span class="co">#   dplyr::mutate(METHOD = &quot;UNWEIGHTED&quot;) %&gt;%</span></a>
<a class="sourceLine" id="cb10-40" data-line-number="40"><span class="co">#   dplyr::mutate(n = tidyr::replace_na(n, 0))</span></a>
<a class="sourceLine" id="cb10-41" data-line-number="41"><span class="co"># </span></a>
<a class="sourceLine" id="cb10-42" data-line-number="42"><span class="co"># </span></a>
<a class="sourceLine" id="cb10-43" data-line-number="43"><span class="co"># # Calculate Domain Estimates</span></a>
<a class="sourceLine" id="cb10-44" data-line-number="44"><span class="co"># Domain_est &lt;- cover_est %&gt;%</span></a>
<a class="sourceLine" id="cb10-45" data-line-number="45"><span class="co">#   dplyr::group_by(REGION, YEAR, cover_group) %&gt;%</span></a>
<a class="sourceLine" id="cb10-46" data-line-number="46"><span class="co">#   dplyr::summarise(avCvr = sum(whavcvr),</span></a>
<a class="sourceLine" id="cb10-47" data-line-number="47"><span class="co">#                    var = sum(whsvar, na.rm = T),</span></a>
<a class="sourceLine" id="cb10-48" data-line-number="48"><span class="co">#                    std = sqrt(var),</span></a>
<a class="sourceLine" id="cb10-49" data-line-number="49"><span class="co">#                    ngrtot = sum(NTOT) )</span></a></code></pre></div>
<p>Example of weighting application for Caribbean and GOM:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co"># Calculate average cover (avcvr), stratum variance (svar), n and std at the strata and regional level using HABITAT as the analysis strata. Inputdata = 1 stage site level cover for major benthic categories and ntot = the most recent NTOT file for the region, regardless of sampling year. </span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co"># </span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co"># cover_est &lt;- inputdata %&gt;%</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#   #group by analysis level strata</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#    dplyr::mutate(ANALYSIS_STRATUM = HABITAT_CD) %&gt;%</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#   dplyr::group_by(YEAR, ANALYSIS_STRATUM, STRAT, cover_group) %&gt;% </span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#   dplyr::summarise(</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">#     # compute average cover</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#     avcvr = mean(Percent_Cvr),</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">#     # compute stratum variance</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#     svar = var(Percent_Cvr),</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="co">#     # calculate N</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="co">#     n = sum(n),</span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="co">#     # calculate mean stratum depth</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="co">#     MIN_DEPTH = mean(MIN_DEPTH),</span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="co">#     MAX_DEPTH = mean(MAX_DEPTH),</span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="co">#     DEPTH_M = (MIN_DEPTH+MAX_DEPTH)/2) %&gt;%</span></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"><span class="co">#   # convert 0 for stratum variance so that the sqrt is a small # but not a 0</span></a>
<a class="sourceLine" id="cb11-20" data-line-number="20"><span class="co">#   dplyr::mutate(svar = dplyr::case_when(svar == 0 ~ 0.00000001,</span></a>
<a class="sourceLine" id="cb11-21" data-line-number="21"><span class="co">#                                         TRUE ~ svar)) %&gt;%</span></a>
<a class="sourceLine" id="cb11-22" data-line-number="22"><span class="co">#   dplyr::mutate(std = sqrt(svar))</span></a>
<a class="sourceLine" id="cb11-23" data-line-number="23"><span class="co"># </span></a>
<a class="sourceLine" id="cb11-24" data-line-number="24"><span class="co"># cover_est &lt;- cover_est %&gt;%</span></a>
<a class="sourceLine" id="cb11-25" data-line-number="25"><span class="co">#   # Merge ntot with cover_est</span></a>
<a class="sourceLine" id="cb11-26" data-line-number="26"><span class="co">#   dplyr::full_join(., ntot) %&gt;%</span></a>
<a class="sourceLine" id="cb11-27" data-line-number="27"><span class="co">#   # stratum estimates</span></a>
<a class="sourceLine" id="cb11-28" data-line-number="28"><span class="co">#   dplyr::mutate(whavcvr = wh * avcvr,</span></a>
<a class="sourceLine" id="cb11-29" data-line-number="29"><span class="co">#                 whsvar = wh^2 * svar,</span></a>
<a class="sourceLine" id="cb11-30" data-line-number="30"><span class="co">#                 whstd = wh * std,</span></a>
<a class="sourceLine" id="cb11-31" data-line-number="31"><span class="co">#                 n = tidyr::replace_na(n, 0),</span></a>
<a class="sourceLine" id="cb11-32" data-line-number="32"><span class="co">#                 # Add the following to match FL format</span></a>
<a class="sourceLine" id="cb11-33" data-line-number="33"><span class="co">#                 PROT = NA,</span></a>
<a class="sourceLine" id="cb11-34" data-line-number="34"><span class="co">#                 RUG_CD = NA)</span></a>
<a class="sourceLine" id="cb11-35" data-line-number="35"></a>
<a class="sourceLine" id="cb11-36" data-line-number="36"><span class="co"># Reformat data </span></a>
<a class="sourceLine" id="cb11-37" data-line-number="37"><span class="co"># </span></a>
<a class="sourceLine" id="cb11-38" data-line-number="38"><span class="co"># cover, unweighted by strata</span></a>
<a class="sourceLine" id="cb11-39" data-line-number="39"><span class="co"># unwh_cover_strata &lt;- cover_est %&gt;%</span></a>
<a class="sourceLine" id="cb11-40" data-line-number="40"><span class="co">#   dplyr::select(REGION, YEAR, ANALYSIS_STRATUM, STRAT, RUG_CD,  DEPTH_M, NTOT, ngrtot, wh, cover_group, n, avcvr, svar, std) %&gt;%</span></a>
<a class="sourceLine" id="cb11-41" data-line-number="41"><span class="co">#   dplyr::mutate(METHOD = &quot;UNWEIGHTED&quot;) %&gt;%</span></a>
<a class="sourceLine" id="cb11-42" data-line-number="42"><span class="co">#   dplyr::mutate(n = tidyr::replace_na(n, 0))</span></a>
<a class="sourceLine" id="cb11-43" data-line-number="43"><span class="co"># </span></a>
<a class="sourceLine" id="cb11-44" data-line-number="44"><span class="co"># </span></a>
<a class="sourceLine" id="cb11-45" data-line-number="45"><span class="co"># # Calculate Domain Estimates</span></a>
<a class="sourceLine" id="cb11-46" data-line-number="46"><span class="co"># Domain_est &lt;- cover_est %&gt;%</span></a>
<a class="sourceLine" id="cb11-47" data-line-number="47"><span class="co">#   dplyr::group_by(REGION, YEAR, cover_group) %&gt;%</span></a>
<a class="sourceLine" id="cb11-48" data-line-number="48"><span class="co">#   dplyr::summarise(avCvr = sum(whavcvr),</span></a>
<a class="sourceLine" id="cb11-49" data-line-number="49"><span class="co">#                    var = sum(whsvar, na.rm = T),</span></a>
<a class="sourceLine" id="cb11-50" data-line-number="50"><span class="co">#                    std = sqrt(var),</span></a>
<a class="sourceLine" id="cb11-51" data-line-number="51"><span class="co">#                    ngrtot = sum(NTOT) )</span></a></code></pre></div>
</div>
</div>
<div id="coral-density" class="section level2">
<h2>Coral density</h2>
<div id="ncrmp_drm_calculate_colony_density" class="section level3">
<h3>4. NCRMP_DRM_calculate_colony_density</h3>
<p><strong>Calculates colony density from site to regional level for all sampling years</strong></p>
<ul>
<li>parameters:
<ul>
<li><p>project: “NCRMP_FRRP” (Florida regions only), “NCRMP” (All regions)</p></li>
<li><p>region: “SEFCRI”, “FLK”, “Tortugas”, “STTSTJ”, “STX”, “PRICO”, “GOM”</p></li>
<li><p>species_filter: A boolean string indicating whether a region-specific preset species filter should be applied to density calculations (TRUE) or all species should be included (FALSE; the default).</p></li>
<li><p>analysis_strat: “STRAT_PROT” (Florida regions only; default), “HABITAT_DEPTH” (Carib regions only; default), “STRAT” (Florida regions only ), “HABITAT” (Carib regions only)</p></li>
</ul></li>
<li><p>outputs (dataframes):</p>
<ul>
<li><p>density_site: site level coral density</p></li>
<li><p>unwh_density_strata: strata level coral density (unweighted)</p></li>
<li><p>Domain estimates: weighted regional (domain level) coral density</p></li>
</ul></li>
</ul>
<p>Associated functions: NCRMP_make_weighted_demo_data, NCRMP_make_weighted_demo_data_RC</p>
<p>Example:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw">require</span>(ncrmp.benthics.analysis)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co"># Run function </span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5">tmp &lt;-<span class="st"> </span><span class="kw">NCRMP_DRM_calculate_colony_density</span>(<span class="dt">project =</span> <span class="st">&quot;NCRMP_FRRP&quot;</span>, </a>
<a class="sourceLine" id="cb12-6" data-line-number="6">                                           <span class="dt">region =</span> <span class="st">&quot;FLK&quot;</span>,</a>
<a class="sourceLine" id="cb12-7" data-line-number="7">                                           <span class="dt">species_filter =</span> <span class="st">&quot;FALSE&quot;</span>,</a>
<a class="sourceLine" id="cb12-8" data-line-number="8">                                           <span class="dt">analysis_strat =</span> <span class="st">&quot;STRAT_PROT&quot;</span>)</a>
<a class="sourceLine" id="cb12-9" data-line-number="9"></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co"># The function will store all of the function outputs as a list in tmp</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co"># Convert list objects to dataframes and rename </span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"></a>
<a class="sourceLine" id="cb12-13" data-line-number="13">NCRMP_DRM_FLK_<span class="dv">2014</span>_<span class="dv">17</span>_density_site &lt;-<span class="st"> </span>tmp<span class="op">$</span>density_site</a>
<a class="sourceLine" id="cb12-14" data-line-number="14">NCRMP_DRM_FLK_<span class="dv">2014</span>_<span class="dv">17</span>_unwh_density_strata &lt;-<span class="st"> </span>tmp<span class="op">$</span>unwh_density_strata</a>
<a class="sourceLine" id="cb12-15" data-line-number="15">NCRMP_DRM_FLK_<span class="dv">2014</span>_<span class="dv">17</span>_wh_density_region &lt;-<span class="st"> </span>tmp<span class="op">$</span>Domain_est</a></code></pre></div>
</div>
<div id="ncrmp_make_weighted_demo_data" class="section level3">
<h3>5. NCRMP_make_weighted_demo_data</h3>
<p><strong>Applies weighting scheme to coral demographic data (coral density, species richness, and mortality).</strong></p>
<p>Analysis level strata = STRAT + PROT for Florida regions and HABITAT CODE + DEPTH STRAT for the Caribbean and GOM regions. These are the recommended and default settings.</p>
<p>This function is called within NCRMP_DRM_calculate_colony_density so the initial parameters you provide for region and year will be passed on.</p>
<p>Example of weighting application for Florida:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co"># Calculate average density (avden), stratum variance (svar), n and std at the strata and regional level using STRAT + PROT as the analysis strata. Inputdata = 1 stage site level coral density and ntot = the most recent NTOT file for the region, regardless of sampling year. </span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co"># density_est &lt;- inputdata %&gt;%</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">#   # group by analysis level strata</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">#   dplyr::mutate(ANALYSIS_STRATUM = paste(STRAT, &quot;/ PROT =&quot;, PROT, sep = &quot; &quot;)) %&gt;%</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">#   dplyr::group_by(YEAR, ANALYSIS_STRATUM, STRAT, PROT) %&gt;% </span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co">#   dplyr::summarise(</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co">#     # compute average density</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co">#     avden = mean(DENSITY),</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">#     # compute stratum variance</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">#     svar = var(DENSITY),</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="co">#     # calculate N</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co">#     n = length(DENSITY)) %&gt;%</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="co">#   # convert 0 for stratum variance so that the sqrt is a small # but not a 0</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="co">#   dplyr::mutate(svar = dplyr::case_when(svar == 0 ~ 0.00000001,</span></a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="co">#                                         TRUE ~ svar)) %&gt;%</span></a>
<a class="sourceLine" id="cb13-18" data-line-number="18"><span class="co">#   dplyr::mutate(std = sqrt(svar))</span></a>
<a class="sourceLine" id="cb13-19" data-line-number="19"><span class="co"># </span></a>
<a class="sourceLine" id="cb13-20" data-line-number="20"><span class="co"># density_est &lt;- density_est %&gt;%</span></a>
<a class="sourceLine" id="cb13-21" data-line-number="21"><span class="co">#   # Merge ntot with coral_est_spp</span></a>
<a class="sourceLine" id="cb13-22" data-line-number="22"><span class="co">#   dplyr::full_join(., ntot) %&gt;%</span></a>
<a class="sourceLine" id="cb13-23" data-line-number="23"><span class="co">#   # stratum estimates</span></a>
<a class="sourceLine" id="cb13-24" data-line-number="24"><span class="co">#   dplyr::mutate(whavden = wh * avden,</span></a>
<a class="sourceLine" id="cb13-25" data-line-number="25"><span class="co">#                 whsvar = wh^2 * svar,</span></a>
<a class="sourceLine" id="cb13-26" data-line-number="26"><span class="co">#                 whstd = wh * std,</span></a>
<a class="sourceLine" id="cb13-27" data-line-number="27"><span class="co">#                 n = tidyr::replace_na(n, 0))</span></a>
<a class="sourceLine" id="cb13-28" data-line-number="28"><span class="co"># </span></a>
<a class="sourceLine" id="cb13-29" data-line-number="29"><span class="co"># # Reformat output</span></a>
<a class="sourceLine" id="cb13-30" data-line-number="30"><span class="co"># </span></a>
<a class="sourceLine" id="cb13-31" data-line-number="31"><span class="co"># unwh_density_strata &lt;-  density_est %&gt;%</span></a>
<a class="sourceLine" id="cb13-32" data-line-number="32"><span class="co">#   dplyr::select(REGION, YEAR, ANALYSIS_STRATUM, STRAT, RUG_CD, PROT, NTOT, ngrtot, wh, n, avden, svar, std)</span></a>
<a class="sourceLine" id="cb13-33" data-line-number="33"><span class="co"># </span></a>
<a class="sourceLine" id="cb13-34" data-line-number="34"><span class="co"># # Calculate Domain Estimates</span></a>
<a class="sourceLine" id="cb13-35" data-line-number="35"><span class="co"># Domain_est &lt;- density_est %&gt;%</span></a>
<a class="sourceLine" id="cb13-36" data-line-number="36"><span class="co">#   dplyr::group_by(REGION, YEAR) %&gt;%</span></a>
<a class="sourceLine" id="cb13-37" data-line-number="37"><span class="co">#   dplyr::summarise(avDen = sum(whavden),</span></a>
<a class="sourceLine" id="cb13-38" data-line-number="38"><span class="co">#                    var = sum(whsvar, na.rm = T),</span></a>
<a class="sourceLine" id="cb13-39" data-line-number="39"><span class="co">#                    std = sqrt(var),</span></a>
<a class="sourceLine" id="cb13-40" data-line-number="40"><span class="co">#                    ngrtot = sum(NTOT) )</span></a></code></pre></div>
<p>Example of weighting application for Caribbean:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co"># Calculate average density (avden), stratum variance (svar), n and std at the strata and regional level using HABITAT + DEPTH_STRAT as the analysis strata. Inputdata = 1 stage site level coral density and ntot = the most recent NTOT file for the region, regardless of sampling year. </span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co"># </span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co"># # Calculate avdns, svar, n and std</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co"># density_est &lt;- inputdata %&gt;%</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#   # group by analysis level strata</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">#   dplyr::mutate(ANALYSIS_STRATUM = STRAT) %&gt;%</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#   dplyr::group_by(YEAR, ANALYSIS_STRATUM, STRAT) %&gt;% </span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">#   dplyr::summarise(# compute average density</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#     avden = mean(DENSITY),</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co">#     # compute stratum variance</span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="co">#     svar = var(DENSITY),</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="co">#     # calculate N</span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">#     n = length(DENSITY)) %&gt;%</span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="co">#   # convert 0 for stratum variance so that the sqrt is a small # but not a 0</span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="co">#   dplyr::mutate(svar = dplyr::case_when(svar == 0 ~ 0.00000001,</span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17"><span class="co">#                                         TRUE ~ svar)) %&gt;%</span></a>
<a class="sourceLine" id="cb14-18" data-line-number="18"><span class="co">#   dplyr::mutate(std = sqrt(svar))</span></a>
<a class="sourceLine" id="cb14-19" data-line-number="19"><span class="co"># </span></a>
<a class="sourceLine" id="cb14-20" data-line-number="20"><span class="co"># density_est &lt;- density_est %&gt;%</span></a>
<a class="sourceLine" id="cb14-21" data-line-number="21"><span class="co">#   # Merge ntot with coral_est_spp</span></a>
<a class="sourceLine" id="cb14-22" data-line-number="22"><span class="co">#   dplyr::full_join(., ntot) %&gt;%</span></a>
<a class="sourceLine" id="cb14-23" data-line-number="23"><span class="co">#   # stratum estimates</span></a>
<a class="sourceLine" id="cb14-24" data-line-number="24"><span class="co">#   dplyr::mutate(whavden = wh * avden,</span></a>
<a class="sourceLine" id="cb14-25" data-line-number="25"><span class="co">#                 whsvar = wh^2 * svar,</span></a>
<a class="sourceLine" id="cb14-26" data-line-number="26"><span class="co">#                 whstd = wh * std,</span></a>
<a class="sourceLine" id="cb14-27" data-line-number="27"><span class="co">#                 n = tidyr::replace_na(n, 0),</span></a>
<a class="sourceLine" id="cb14-28" data-line-number="28"><span class="co">#                 # Add the following to match FL format </span></a>
<a class="sourceLine" id="cb14-29" data-line-number="29"><span class="co">#                 PROT = NA,           </span></a>
<a class="sourceLine" id="cb14-30" data-line-number="30"><span class="co">#                 RUG_CD = NA)</span></a>
<a class="sourceLine" id="cb14-31" data-line-number="31"><span class="co"># </span></a>
<a class="sourceLine" id="cb14-32" data-line-number="32"><span class="co"># # Reformat output</span></a>
<a class="sourceLine" id="cb14-33" data-line-number="33"><span class="co"># </span></a>
<a class="sourceLine" id="cb14-34" data-line-number="34"><span class="co"># unwh_density_strata &lt;-  density_est %&gt;%</span></a>
<a class="sourceLine" id="cb14-35" data-line-number="35"><span class="co">#   dplyr::select(REGION, YEAR, ANALYSIS_STRATUM, STRAT, RUG_CD, PROT, NTOT, ngrtot, wh, n, avden, svar, std)</span></a>
<a class="sourceLine" id="cb14-36" data-line-number="36"><span class="co"># </span></a>
<a class="sourceLine" id="cb14-37" data-line-number="37"><span class="co"># # Calculate Domain Estimates</span></a>
<a class="sourceLine" id="cb14-38" data-line-number="38"><span class="co"># Domain_est &lt;- density_est %&gt;%</span></a>
<a class="sourceLine" id="cb14-39" data-line-number="39"><span class="co">#   dplyr::group_by(REGION, YEAR) %&gt;%</span></a>
<a class="sourceLine" id="cb14-40" data-line-number="40"><span class="co">#   dplyr::summarise(avDen = sum(whavden),</span></a>
<a class="sourceLine" id="cb14-41" data-line-number="41"><span class="co">#                    var = sum(whsvar, na.rm = T),</span></a>
<a class="sourceLine" id="cb14-42" data-line-number="42"><span class="co">#                    std = sqrt(var),</span></a>
<a class="sourceLine" id="cb14-43" data-line-number="43"><span class="co">#                    ngrtot = sum(NTOT) )</span></a></code></pre></div>
</div>
<div id="ncrmp_make_weighted_demo_data_rc" class="section level3">
<h3>6. NCRMP_make_weighted_demo_data_RC</h3>
<p><strong>Applies weighting scheme to coral demographic data (coral density, species richness, and mortality).</strong></p>
<p>Analysis level strata = STRAT for Florida regions and HABITAT CODE for the Caribbean and GOM regions.</p>
<p>This function is called within NCRMP_DRM_calculate_colony_density so the initial parameters you provide for region and year will be passed on.</p>
<p>Example of weighting application for Florida:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="co"># # Calculate average density (avden), stratum variance (svar), n and std at the strata and regional level using STRAT as the analysis strata. Inputdata = 1 stage site level coral density and ntot = the most recent NTOT file for the region, regardless of sampling year. </span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="co"># </span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="co"># # Calculate avdns, svar, n and std</span></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="co"># density_est &lt;- inputdata %&gt;%</span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="co">#   # group by analysis level strata</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="co">#   dplyr::mutate(ANALYSIS_STRATUM = STRAT) %&gt;%</span></a>
<a class="sourceLine" id="cb15-9" data-line-number="9"><span class="co">#   dplyr::group_by(YEAR, ANALYSIS_STRATUM, STRAT) %&gt;% </span></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="co">#   dplyr::summarise(</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="co">#     # compute average density</span></a>
<a class="sourceLine" id="cb15-12" data-line-number="12"><span class="co">#     avden = mean(DENSITY),</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13"><span class="co">#     # compute stratum variance</span></a>
<a class="sourceLine" id="cb15-14" data-line-number="14"><span class="co">#     svar = var(DENSITY),</span></a>
<a class="sourceLine" id="cb15-15" data-line-number="15"><span class="co">#     n = length(DENSITY)) %&gt;%</span></a>
<a class="sourceLine" id="cb15-16" data-line-number="16"><span class="co">#   # convert 0 for stratum variance so that the sqrt is a small # but not a 0</span></a>
<a class="sourceLine" id="cb15-17" data-line-number="17"><span class="co">#   dplyr::mutate(svar = dplyr::case_when(svar == 0 ~ 0.00000001,</span></a>
<a class="sourceLine" id="cb15-18" data-line-number="18"><span class="co">#                                         TRUE ~ svar)) %&gt;%</span></a>
<a class="sourceLine" id="cb15-19" data-line-number="19"><span class="co">#   dplyr::mutate(std = sqrt(svar))</span></a>
<a class="sourceLine" id="cb15-20" data-line-number="20"><span class="co"># </span></a>
<a class="sourceLine" id="cb15-21" data-line-number="21"><span class="co"># density_est &lt;- density_est %&gt;%</span></a>
<a class="sourceLine" id="cb15-22" data-line-number="22"><span class="co">#   # Merge ntot with coral_est_spp</span></a>
<a class="sourceLine" id="cb15-23" data-line-number="23"><span class="co">#   dplyr::full_join(., ntot) %&gt;%</span></a>
<a class="sourceLine" id="cb15-24" data-line-number="24"><span class="co">#   # stratum estimates</span></a>
<a class="sourceLine" id="cb15-25" data-line-number="25"><span class="co">#   dplyr::mutate(whavden = wh * avden,</span></a>
<a class="sourceLine" id="cb15-26" data-line-number="26"><span class="co">#                 whsvar = wh^2 * svar,</span></a>
<a class="sourceLine" id="cb15-27" data-line-number="27"><span class="co">#                 whstd = wh * std,</span></a>
<a class="sourceLine" id="cb15-28" data-line-number="28"><span class="co">#                 n = tidyr::replace_na(n, 0))</span></a>
<a class="sourceLine" id="cb15-29" data-line-number="29"><span class="co"># </span></a>
<a class="sourceLine" id="cb15-30" data-line-number="30"><span class="co"># # Reformat output</span></a>
<a class="sourceLine" id="cb15-31" data-line-number="31"><span class="co"># </span></a>
<a class="sourceLine" id="cb15-32" data-line-number="32"><span class="co"># unwh_density_strata &lt;-  density_est %&gt;%</span></a>
<a class="sourceLine" id="cb15-33" data-line-number="33"><span class="co">#   dplyr::select(REGION, YEAR, ANALYSIS_STRATUM, RUG_CD, NTOT, ngrtot, wh, n, avden, svar, std)</span></a>
<a class="sourceLine" id="cb15-34" data-line-number="34"><span class="co"># </span></a>
<a class="sourceLine" id="cb15-35" data-line-number="35"><span class="co"># # Domain Estimates</span></a>
<a class="sourceLine" id="cb15-36" data-line-number="36"><span class="co"># Domain_est &lt;- density_est %&gt;%</span></a>
<a class="sourceLine" id="cb15-37" data-line-number="37"><span class="co">#   dplyr::group_by(REGION, YEAR) %&gt;%</span></a>
<a class="sourceLine" id="cb15-38" data-line-number="38"><span class="co">#   dplyr::summarise(avDen = sum(whavden),</span></a>
<a class="sourceLine" id="cb15-39" data-line-number="39"><span class="co">#                    var = sum(whsvar, na.rm = T),</span></a>
<a class="sourceLine" id="cb15-40" data-line-number="40"><span class="co">#                    std = sqrt(var),</span></a>
<a class="sourceLine" id="cb15-41" data-line-number="41"><span class="co">#                    ngrtot = sum(NTOT) )</span></a></code></pre></div>
<p>Example of weighting application for Caribbean:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co"># #  Calculate average density (avden), stratum variance (svar), n and std at the strata and regional level using HABITAT_CD as the analysis strata. Inputdata = 1 stage site level coral density and ntot = the most recent NTOT file for the region, regardless of sampling year. </span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="co"># </span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="co"># # Calculate avdns, svar, n and std</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="co"># density_est &lt;- inputdata %&gt;%</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="co">#   # group by analysis level strata</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="co">#   dplyr::mutate(ANALYSIS_STRATUM = HABITAT_CD) %&gt;%</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="co">#   dplyr::group_by(YEAR, ANALYSIS_STRATUM, HABITAT_CD) %&gt;% </span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="co">#   dplyr::summarise(# compute average density</span></a>
<a class="sourceLine" id="cb16-10" data-line-number="10"><span class="co">#     avden = mean(DENSITY),</span></a>
<a class="sourceLine" id="cb16-11" data-line-number="11"><span class="co">#     # compute stratum variance</span></a>
<a class="sourceLine" id="cb16-12" data-line-number="12"><span class="co">#     svar = var(DENSITY),</span></a>
<a class="sourceLine" id="cb16-13" data-line-number="13"><span class="co">#     n = length(DENSITY)) %&gt;%</span></a>
<a class="sourceLine" id="cb16-14" data-line-number="14"><span class="co">#   # convert 0 for stratum variance so that the sqrt is a small # but not a 0</span></a>
<a class="sourceLine" id="cb16-15" data-line-number="15"><span class="co">#   dplyr::mutate(svar = dplyr::case_when(svar == 0 ~ 0.00000001,</span></a>
<a class="sourceLine" id="cb16-16" data-line-number="16"><span class="co">#                                         TRUE ~ svar)) %&gt;%</span></a>
<a class="sourceLine" id="cb16-17" data-line-number="17"><span class="co">#   dplyr::mutate(std = sqrt(svar))</span></a>
<a class="sourceLine" id="cb16-18" data-line-number="18"><span class="co"># </span></a>
<a class="sourceLine" id="cb16-19" data-line-number="19"><span class="co"># density_est &lt;- density_est %&gt;%</span></a>
<a class="sourceLine" id="cb16-20" data-line-number="20"><span class="co">#   # Merge ntot with coral_est_spp</span></a>
<a class="sourceLine" id="cb16-21" data-line-number="21"><span class="co">#   dplyr::full_join(., ntot) %&gt;%</span></a>
<a class="sourceLine" id="cb16-22" data-line-number="22"><span class="co">#   # stratum estimates</span></a>
<a class="sourceLine" id="cb16-23" data-line-number="23"><span class="co">#   dplyr::mutate(whavden = wh * avden,</span></a>
<a class="sourceLine" id="cb16-24" data-line-number="24"><span class="co">#                 whsvar = wh^2 * svar,</span></a>
<a class="sourceLine" id="cb16-25" data-line-number="25"><span class="co">#                 whstd = wh * std,</span></a>
<a class="sourceLine" id="cb16-26" data-line-number="26"><span class="co">#                 n = tidyr::replace_na(n, 0),</span></a>
<a class="sourceLine" id="cb16-27" data-line-number="27"><span class="co">#                 # Add the following to match FL format</span></a>
<a class="sourceLine" id="cb16-28" data-line-number="28"><span class="co">#                 RUG_CD = NA)</span></a>
<a class="sourceLine" id="cb16-29" data-line-number="29"><span class="co"># </span></a>
<a class="sourceLine" id="cb16-30" data-line-number="30"><span class="co"># # Reformat output</span></a>
<a class="sourceLine" id="cb16-31" data-line-number="31"><span class="co"># </span></a>
<a class="sourceLine" id="cb16-32" data-line-number="32"><span class="co"># unwh_density_strata &lt;-  density_est %&gt;%</span></a>
<a class="sourceLine" id="cb16-33" data-line-number="33"><span class="co">#   dplyr::select(REGION, YEAR, ANALYSIS_STRATUM, RUG_CD, NTOT, ngrtot, wh, n, avden, svar, std)</span></a>
<a class="sourceLine" id="cb16-34" data-line-number="34"><span class="co"># </span></a>
<a class="sourceLine" id="cb16-35" data-line-number="35"><span class="co"># # Domain Estimates</span></a>
<a class="sourceLine" id="cb16-36" data-line-number="36"><span class="co"># Domain_est &lt;- density_est %&gt;%</span></a>
<a class="sourceLine" id="cb16-37" data-line-number="37"><span class="co">#   dplyr::group_by(REGION, YEAR) %&gt;%</span></a>
<a class="sourceLine" id="cb16-38" data-line-number="38"><span class="co">#   dplyr::summarise(avDen = sum(whavden),</span></a>
<a class="sourceLine" id="cb16-39" data-line-number="39"><span class="co">#                    var = sum(whsvar, na.rm = T),</span></a>
<a class="sourceLine" id="cb16-40" data-line-number="40"><span class="co">#                    std = sqrt(var),</span></a>
<a class="sourceLine" id="cb16-41" data-line-number="41"><span class="co">#                    ngrtot = sum(NTOT) )</span></a></code></pre></div>
</div>
</div>
<div id="species-richness-and-diversity" class="section level2">
<h2>Species richness and diversity</h2>
<div id="ncrmp_drm_calculate_species_richness_diversity" class="section level3">
<h3>7. NCRMP_DRM_calculate_species_richness_diversity</h3>
<p><strong>Calculates species richness from site to regional level for all sampling years. Calculates Simpson, Inverse Simpson and Shannon–Wiener diversity indices from site to regional level for all sampling years using the R package vegan.</strong></p>
<ul>
<li>parameters:
<ul>
<li><p>project: “NCRMP_FRRP” (Florida regions only), “NCRMP” (All regions)</p></li>
<li><p>region: “SEFCRI”, “FLK”, “Tortugas”, “STTSTJ”, “STX”, “PRICO”, “GOM”</p></li>
<li><p>analysis_strat: “STRAT_PROT” (Florida regions only; default), “HABITAT_DEPTH” (Carib regions only; default), “STRAT” (Florida regions only ), “HABITAT” (Carib regions only)</p></li>
</ul></li>
<li><p>outputs (dataframes):</p>
<ul>
<li><p>species_list: a list of a species present for all sampling years</p></li>
<li><p>richness_site: site level species richness</p></li>
<li><p>unwh_richness_strata: strata level species richness (unweighted)</p></li>
<li><p>Domain estimates: weighted regional (domain level) species richness</p></li>
<li><p>species_diversity_site: site level species diversity using the Simpson, Inverse Simpson and Shannon-Weiner diversity indices *only calculated if analysis_stata = “STRAT_PROT” or “STRAT_DEPTH”</p></li>
<li><p>species_diversity_strata: strata level species diversity using the Simpson, Inverse Simpson and Shannon-Weiner diversity indices (unweighted) *only calculated if analysis_stata = “STRAT_PROT” or “STRAT_DEPTH”</p></li>
<li><p>species_diversity_region: weighted regional (domain level) species diversity using the Simpson, Inverse Simpson and Shannon-Weiner diversity indices *only calculated if analysis_stata = “STRAT_PROT” or “STRAT_DEPTH”</p></li>
</ul></li>
</ul>
<p>Associated functions: NCRMP_make_weighted_demo_data, NCRMP_make_weighted_demo_data_RC</p>
<p>Example:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw">require</span>(ncrmp.benthics.analysis)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="co"># Run function </span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5">tmp &lt;-<span class="st"> </span><span class="kw">NCRMP_DRM_calculate_species_richness_diversity</span>(<span class="dt">project =</span> <span class="st">&quot;NCRMP&quot;</span>,</a>
<a class="sourceLine" id="cb17-6" data-line-number="6">                                                       <span class="dt">region=</span> <span class="st">&quot;Tortugas&quot;</span>,</a>
<a class="sourceLine" id="cb17-7" data-line-number="7">                                                       <span class="dt">analysis_strat =</span> <span class="st">&quot;STRAT_PROT&quot;</span>)</a>
<a class="sourceLine" id="cb17-8" data-line-number="8"></a>
<a class="sourceLine" id="cb17-9" data-line-number="9"><span class="co"># The function will store all of the function outputs as a list in tmp</span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="co"># Convert list objects to dataframes and rename </span></a>
<a class="sourceLine" id="cb17-11" data-line-number="11"></a>
<a class="sourceLine" id="cb17-12" data-line-number="12">NCRMP_Tort_<span class="dv">2014</span>_<span class="dv">16</span>_spp_list &lt;-<span class="st"> </span>tmp<span class="op">$</span>species_list </a>
<a class="sourceLine" id="cb17-13" data-line-number="13">NCRMP_Tort_<span class="dv">2014</span>_<span class="dv">16</span>_richness_site &lt;-<span class="st"> </span>tmp<span class="op">$</span>richness_site</a>
<a class="sourceLine" id="cb17-14" data-line-number="14">NCRMP_Tort_<span class="dv">2014</span>_<span class="dv">16</span>_unwh_richness_strata &lt;-<span class="st"> </span>tmp<span class="op">$</span>unwh_richness_strata</a>
<a class="sourceLine" id="cb17-15" data-line-number="15">NCRMP_Tort_<span class="dv">2014</span>_<span class="dv">16</span>_wh_richness_region &lt;-<span class="st"> </span>tmp<span class="op">$</span>Domain_est</a>
<a class="sourceLine" id="cb17-16" data-line-number="16"></a>
<a class="sourceLine" id="cb17-17" data-line-number="17">NCRMP_Tort_<span class="dv">2014</span>_<span class="dv">16</span>_diversity_site &lt;-<span class="st"> </span>tmp<span class="op">$</span>species_diversity_site</a>
<a class="sourceLine" id="cb17-18" data-line-number="18">NCRMP_Tort_<span class="dv">2014</span>_<span class="dv">16</span>_diversity_strata &lt;-<span class="st"> </span>tmp<span class="op">$</span>unwh_diversity_strata</a>
<a class="sourceLine" id="cb17-19" data-line-number="19">NCRMP_Tort_<span class="dv">2014</span>_<span class="dv">16</span>_diversity_region &lt;-<span class="st"> </span>tmp<span class="op">$</span>Domain_est_div</a></code></pre></div>
<p>Regional species richness and diversity are calculated using the same weighting scheme as coral density. See NCRMP_make_weighted_demo_data and NCRMP_make_weighted_demo_data_RC for example code. Only the default analysis strat settings are available for species diversity. See <a href="https://cran.r-project.org/web/packages/vegan/vegan.pdf" class="uri">https://cran.r-project.org/web/packages/vegan/vegan.pdf</a> for more information on the diversity indices.</p>
</div>
</div>
<div id="mortality" class="section level2">
<h2>Mortality</h2>
<div id="ncrmp_drm_calculate_mortality" class="section level3">
<h3>8. NCRMP_DRM_calculate_mortality</h3>
<p><strong>Calculates old and recent mortality (percent of colony surface) from species to regional level for all sampling years</strong></p>
<ul>
<li>parameters:
<ul>
<li><p>project: “NCRMP_FRRP” (Florida regions only), “NCRMP” (All regions)</p></li>
<li><p>region: “SEFCRI”, “FLK”, “Tortugas”, “STTSTJ”, “STX”, “PRICO”, “GOM”</p></li>
<li><p>species_filter: A boolean string indicating whether a region-specific preset species filter should be applied to density calculations (TRUE) or all species should be included (FALSE; the default).</p></li>
<li><p>analysis_strat: “STRAT_PROT” (Florida regions only; default), “HABITAT_DEPTH” (Carib regions only; default), “STRAT” (Florida regions only ), “HABITAT” (Carib regions only)</p></li>
</ul></li>
<li><p>outputs (dataframes):</p>
<ul>
<li><p>density_site: site level mortality</p></li>
<li><p>unwh_density_strata: strata level mortality (unweighted)</p></li>
<li><p>Domain estimates: weighted regional (domain level) mortality</p></li>
</ul></li>
</ul>
<p>Associated functions: NCRMP_make_weighted_demo_data, NCRMP_make_weighted_demo_data_RC</p>
<p>Example:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="kw">require</span>(ncrmp.benthics.analysis)</a>
<a class="sourceLine" id="cb18-3" data-line-number="3"></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="co"># Run function</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5">tmp &lt;-<span class="st"> </span><span class="kw">NCRMP_DRM_calculate_mortality</span>(<span class="dt">project =</span> <span class="st">&quot;NCRMP&quot;</span>,</a>
<a class="sourceLine" id="cb18-6" data-line-number="6">                                      <span class="dt">region =</span> <span class="st">&quot;GOM&quot;</span>,</a>
<a class="sourceLine" id="cb18-7" data-line-number="7">                                      <span class="dt">species_filter =</span> <span class="st">&quot;TRUE&quot;</span>,</a>
<a class="sourceLine" id="cb18-8" data-line-number="8">                                      <span class="dt">analysis_strat =</span> <span class="st">&quot;HABITAT_DEPTH&quot;</span>)</a>
<a class="sourceLine" id="cb18-9" data-line-number="9"></a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="co"># The function will store all of the function outputs as a list in tmp</span></a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="co"># Convert list objects to dataframes and rename</span></a>
<a class="sourceLine" id="cb18-12" data-line-number="12"></a>
<a class="sourceLine" id="cb18-13" data-line-number="13">NCRMP_FGBNMS_<span class="dv">2013</span>_<span class="dv">15</span>_old_mort_site &lt;-<span class="st"> </span>tmp<span class="op">$</span>old_mortality_site</a>
<a class="sourceLine" id="cb18-14" data-line-number="14">NCRMP_FGBNMS_<span class="dv">2013</span>_<span class="dv">15</span>_rec_mort_site &lt;-<span class="st"> </span>tmp<span class="op">$</span>recent_mortality_site</a>
<a class="sourceLine" id="cb18-15" data-line-number="15"></a>
<a class="sourceLine" id="cb18-16" data-line-number="16">NCRMP_FGBNMS_<span class="dv">2013</span>_<span class="dv">15</span>_unwh_old_mort_strata &lt;-<span class="st"> </span>tmp<span class="op">$</span>unwh_old_mortality_strata</a>
<a class="sourceLine" id="cb18-17" data-line-number="17">NCRMP_FGBNMS_<span class="dv">2013</span>_<span class="dv">15</span>_unwh_rec_mort_strata &lt;-<span class="st"> </span>tmp<span class="op">$</span>unwh_rec_mortality_strata</a>
<a class="sourceLine" id="cb18-18" data-line-number="18"></a>
<a class="sourceLine" id="cb18-19" data-line-number="19">NCRMP_FGBNMS_<span class="dv">2013</span>_<span class="dv">15</span>_wh_old_mort_region &lt;-<span class="st"> </span>tmp<span class="op">$</span>Domain_est_old_mort</a>
<a class="sourceLine" id="cb18-20" data-line-number="20">NCRMP_FGBNMS_<span class="dv">2013</span>_<span class="dv">15</span>_wh_rec_mort_region &lt;-<span class="st"> </span>tmp<span class="op">$</span>Domain_est_rec_mort</a></code></pre></div>
<p>Regional old and recent mortality are calculated using the same weighting scheme as coral density. See NCRMP_make_weighted_demo_data and NCRMP_make_weighted_demo_data_RC for example code.</p>
</div>
</div>
<div id="invertebrate-density" class="section level2">
<h2>Invertebrate density</h2>
<div id="ncrmp_calculate_invert_density" class="section level3">
<h3>9. NCRMP_calculate_invert_density</h3>
<p><strong>Calculates <em>Diadema antillarum</em> density from site to regional level for all sampling years</strong></p>
<ul>
<li><p>parameters:</p>
<ul>
<li>region: “SEFCRI”, “FLK”, “Tortugas”, “STTSTJ”, “STX”, “PRICO”, “GOM”</li>
</ul></li>
<li><p>outputs (dataframes):</p>
<ul>
<li><p>diadema_density_site: site level Diadema density</p></li>
<li><p>unwh_invert_strata: strata level Diadema density (unweighted)</p></li>
<li><p>Domain estimates: weighted regional (domain level) Diadema density</p></li>
</ul></li>
</ul>
<p>Associated functions: NCRMP_make_weighted_invert_density</p>
<p>Example:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="kw">require</span>(ncrmp.benthics.analysis)</a>
<a class="sourceLine" id="cb19-3" data-line-number="3"></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="co"># Run function </span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6">tmp &lt;-<span class="st"> </span><span class="kw">NCRMP_calculate_invert_density</span>(<span class="dt">region =</span> <span class="st">&quot;PRICO&quot;</span>)</a>
<a class="sourceLine" id="cb19-7" data-line-number="7"></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="co"># The function will store all of the function outputs as a list in tmp</span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="co"># Convert list objects to dataframes and rename </span></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"></a>
<a class="sourceLine" id="cb19-11" data-line-number="11">NCRMP_PRICO_<span class="dv">2014</span>_<span class="dv">16</span>_invert_den_site &lt;-<span class="st"> </span>tmp<span class="op">$</span>diadema_density_site</a>
<a class="sourceLine" id="cb19-12" data-line-number="12">NCRMP_PRICO_<span class="dv">2014</span>_<span class="dv">16</span>_unwh_invert_den_strata &lt;-<span class="st"> </span>tmp<span class="op">$</span>unwh_invert_strata <span class="co"># Right now just Diadema</span></a>
<a class="sourceLine" id="cb19-13" data-line-number="13">NCRMP_PRICO_<span class="dv">2014</span>_<span class="dv">16</span>_wh_invert_den_region &lt;-<span class="st"> </span>tmp<span class="op">$</span>Domain_est</a></code></pre></div>
<p>Regional <em>Diadema</em> density is calculated using the same weighting scheme as coral density. See NCRMP_make_weighted_invert_density for example code. This function is currently only calculating <em>Diadema</em> density. Future updates will include conch and lobster; but until these updates are complete, please see the code in this function for guidance on how to calculate density for the other invertebrates.</p>
</div>
</div>
<div id="disease-prevalence" class="section level2">
<h2>Disease prevalence</h2>
<div id="ncrmp_drm_calculate_disease_prevalence" class="section level3">
<h3>10. NCRMP_DRM_calculate_disease_prevalence</h3>
<p><strong>Calculates disease prevalence at the site (% colonies per site), strata (mean of % colonies per site), and regional (weighted mean of % colonies per site) level for all sampling years</strong></p>
<ul>
<li>parameters:
<ul>
<li><p>project: “NCRMP_FRRP” (Florida regions only), “NCRMP” (All regions)</p></li>
<li><p>region: “SEFCRI”, “FLK”, “Tortugas”, “STTSTJ”, “STX”, “PRICO”, “GOM”</p></li>
<li><p>species_filter: A boolean string indicating whether a region-specific preset species filter should be applied to density calculations (TRUE) or all species should be included (FALSE; the default).</p></li>
</ul></li>
<li><p>outputs (dataframes):</p>
<ul>
<li><p>disease_prev_site: site level disease prevalence</p></li>
<li><p>unwh_dis_prev_strata: strata level disease prevalence (unweighted)</p></li>
<li><p>Domain estimates: weighted regional (domain level) disease prevalence</p></li>
</ul></li>
</ul>
<p>Associated functions: NCRMP_make_weighted_demo_data, NCRMP_make_weighted_demo_data_RC</p>
<p>Example:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="kw">require</span>(ncrmp.benthics.analysis)</a>
<a class="sourceLine" id="cb20-3" data-line-number="3"></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="co"># Run function </span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"></a>
<a class="sourceLine" id="cb20-6" data-line-number="6">tmp &lt;-<span class="st"> </span><span class="kw">NCRMP_DRM_calculate_disease_prevalence</span>(<span class="dt">project =</span> <span class="st">&quot;NCRMP_FRRP&quot;</span>,</a>
<a class="sourceLine" id="cb20-7" data-line-number="7">                                        <span class="dt">region =</span> <span class="st">&quot;SEFCRI&quot;</span>,</a>
<a class="sourceLine" id="cb20-8" data-line-number="8">                                        <span class="dt">species_filter =</span> <span class="st">&quot;FALSE&quot;</span>)</a>
<a class="sourceLine" id="cb20-9" data-line-number="9"></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="co"># The function will store all of the function outputs as a list in tmp</span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="co"># Convert list objects to dataframes and rename </span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"></a>
<a class="sourceLine" id="cb20-13" data-line-number="13">NCRMP_DRM_SEFCRI_<span class="dv">2014</span>_<span class="dv">17</span>_dis_prev_site &lt;-<span class="st"> </span>tmp<span class="op">$</span>disease_prev_site</a>
<a class="sourceLine" id="cb20-14" data-line-number="14">NCRMP_DRM_SEFCRI_<span class="dv">2014</span>_<span class="dv">17</span>_unwh_dis_prev_strata &lt;-<span class="st"> </span>tmp<span class="op">$</span>unwh_dis_prev_strata</a>
<a class="sourceLine" id="cb20-15" data-line-number="15">NCRMP_DRM_SEFCRI_<span class="dv">2014</span>_<span class="dv">17</span>_wh_dis_prev_region &lt;-<span class="st"> </span>tmp<span class="op">$</span>Domain_est</a></code></pre></div>
<p>Regional disease prevalence are calculated using the same weighting scheme as coral density. See NCRMP_make_weighted_demo_data and NCRMP_make_weighted_demo_data_RC for example code.</p>
<p>Note: Disease was not sampled in the Flower Garden Banks National Marine Sanctuary (FGBNMS) in 2013</p>
</div>
</div>
</div>
<div id="functions-for-all-regions-and-years" class="section level1">
<h1>Functions for all regions and years</h1>
<div id="these-functions-create-outputs-that-contain-all-regions-and-all-years.-they-are-not-weighted." class="section level3">
<h3>These functions create outputs that contain all regions and all years. They are not weighted.</h3>
</div>
<div id="esa-listed-corals---presence-absence" class="section level2">
<h2>ESA listed corals - presence absence</h2>
<div id="ncrmp_calculate_esa_corals_presabs" class="section level3">
<h3>11. NCRMP_calculate_ESA_corals_PresAbs</h3>
<p><strong>Calculates strata level presence / absence for all regions and sampling years. Sums total number of ESA species per strata. Currently NCRMP data only.</strong></p>
<ul>
<li>parameters:
<ul>
<li>None</li>
</ul></li>
<li><p>outputs (dataframes):</p>
<ul>
<li><p>NCRMP_AllRegions_Years_ESA_PresAbs: strata level ESA presence/absence</p></li>
<li><p>region_year: a list to check that every region and year is included</p></li>
</ul></li>
</ul>
<p>Associated functions: None</p>
<p>Example:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">require</span>(ncrmp.benthics.analysis)</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="co"># Run function </span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4">tmp &lt;-<span class="st"> </span><span class="kw">NCRMP_calculate_ESA_corals_PresAbs</span>()</a>
<a class="sourceLine" id="cb21-5" data-line-number="5"></a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="co"># The function will store all of the function outputs as a list in tmp</span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="co"># Convert list objects to dataframes and rename </span></a>
<a class="sourceLine" id="cb21-8" data-line-number="8"></a>
<a class="sourceLine" id="cb21-9" data-line-number="9">NCRMP_AllRegions_Years_ESA_PresAbs &lt;-<span class="st"> </span>tmp<span class="op">$</span>NCRMP_AllRegions_Years_ESA_PresAbs</a>
<a class="sourceLine" id="cb21-10" data-line-number="10">region_year &lt;-<span class="st"> </span>tmp<span class="op">$</span>region_year </a></code></pre></div>
</div>
</div>
<div id="bleaching-abundance" class="section level2">
<h2>Bleaching abundance</h2>
<div id="ncrmp_make_bleaching_abundance" class="section level3">
<h3>12. NCRMP_make_bleaching_abundance</h3>
<p><strong>Calculates species level bleaching abundance by each transect for all regions and sampling years. Currently NCRMP data only</strong></p>
<ul>
<li>parameters:
<ul>
<li>None</li>
</ul></li>
<li><p>outputs (dataframes):</p>
<ul>
<li>NCRMP_bleaching_abundance_Allyears_Allregions: species level bleaching abundance for each transect</li>
</ul></li>
</ul>
<p>Associated functions: None</p>
<p>Example:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">require</span>(ncrmp.benthics.analysis)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2"></a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="co"># Run function </span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"></a>
<a class="sourceLine" id="cb22-5" data-line-number="5">tmp &lt;-<span class="st"> </span><span class="kw">NCRMP_make_bleaching_abundance</span>()</a>
<a class="sourceLine" id="cb22-6" data-line-number="6"></a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="co"># The function will store all of the function outputs as a list in tmp</span></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="co"># Convert list objects to dataframes and rename </span></a>
<a class="sourceLine" id="cb22-9" data-line-number="9"></a>
<a class="sourceLine" id="cb22-10" data-line-number="10">NCRMP_bleaching_abundance_Allyears_Allregions &lt;-<span class="st"> </span>tmp<span class="op">$</span>NCRMP_bleaching_abundance_Allyears_Allregions</a></code></pre></div>
<hr />
</div>
</div>
</div>
<div id="frequently-asked-questions" class="section level1">
<h1>Frequently asked questions:</h1>
<div id="what-species-are-used-when-you-filter-the-species-in-ncrmp_drm_calculate_colony_density-ncrmp_drm_calculate_disease_prevalence-or-ncrmp_drm_calculate_mortality" class="section level3">
<h3>1. What species are used when you filter the species in NCRMP_DRM_calculate_colony_density, NCRMP_DRM_calculate_disease_prevalence or NCRMP_DRM_calculate_mortality?</h3>
</div>
</div>
<div id="ncrmp-species-filter-developed-in-status-report-meetings" class="section level1">
<h1>NCRMP species filter developed in status report meetings</h1>
<p>Report_card_filter &lt;- c(“ACR CERV”, “ACR PALM”, “COL NATA”, “DIP LABY”, “MON CAVE”, “ORB ANNU”, “ORB FRAN”, “ORB FAVE”, “POR PORI”, “PSE STRI”, “PSE CLIV”, “SID SIDE”, “STE INTE”)</p>
<div id="which-benthic-categories-are-combined-into-other-in-ncrmp_calculate_cover" class="section level3">
<h3>2. Which benthic categories are combined into “OTHER” in NCRMP_calculate_cover?</h3>
<p>The following major benthic categories are currently classified as OTHER in the benthic cover metrics: SUBSTRATE, HYDROCORALS, OTHER INVERTEBRATES, CYANOBACTERIA, and SEAGRASS. Please see ncrmp_frrp_sppcodes, which is contained in the package, for information on how taxa are categorized into major benthic categories.</p>
</div>
</div>
<div id="disclaimer" class="section level1">
<h1>Disclaimer</h1>
<p>This repository is a scientific product and is not official communication of the National Oceanic and Atmospheric Administration, or the United States Department of Commerce. All NOAA GitHub project code is provided on an ‘as is’ basis and the user assumes responsibility for its use. Any claims against the Department of Commerce or Department of Commerce bureaus stemming from the use of this GitHub project will be governed by all applicable Federal law. Any reference to specific commercial products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply their endorsement, recommendation or favoring by the Department of Commerce. The Department of Commerce seal and logo, or the seal and logo of a DOC bureau, shall not be used in any manner to imply endorsement of any commercial product or activity by DOC or the United States Government.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
